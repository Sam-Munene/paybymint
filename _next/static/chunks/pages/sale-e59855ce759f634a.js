(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[761],{24833:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sale",function(){return n(29742)}])},93459:function(e,t,n){"use strict";n.d(t,{sD:function(){return r}});var s=n(70148),r=(n(40993),function(e){s.Am.error(e,{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"colored"})})},29742:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var s,r,a,o,l=n(47568),i=n(14924),c=n(10092),u=n(85893),d=n(11163),m=n(67294),x=n(25617),h=n(98690),p=n.n(h),f=n(14517),g=n(43135),j=n(24456),y=n(11434),v=n(60545),b=n(82169),w=n(64146),N=n(70794),C=n(70148),S=n(86455),Z=n.n(S),k=n(77630),B=n.n(k),P=n(8592),_=n(93459),E=n(14344),F=n.n(E),L=n(9669),D=n.n(L),T=n(31607),A=(n(95291),n(36823)),I=n(9008),U=n.n(I),M=new(p().SES)(A),H=B()(Z());function O(){var e=(0,m.useState)(!1),t=e[0],n=e[1],i=(0,m.useState)(!1),h=i[0],p=i[1],f=(0,x.v9)((function(e){return e.user.address})),S=(0,x.v9)((function(e){return e.user.blockchain})),Z=(0,x.v9)((function(e){return e.user.provider})),k=(0,m.useState)(0),B=k[0],E=k[1],F=(0,m.useState)("0"),L=F[0],T=F[1],A=(0,m.useState)(0),I=A[0],O=A[1],K=(0,m.useState)(""),X=K[0],Y=K[1],q=(0,m.useState)(""),J=q[0],G=q[1],Q=(0,m.useState)(""),W=Q[0],$=Q[1],ee=(0,m.useState)(""),te=ee[0],ne=ee[1],se=(0,m.useState)(!1),re=se[0],ae=se[1],oe=(0,m.useState)(0),le=oe[0],ie=oe[1],ce=(0,m.useState)(1),ue=ce[0],de=ce[1],me=(0,m.useState)(1),xe=me[0],he=me[1],pe=(0,m.useState)(""),fe=pe[0],ge=pe[1],je=(0,m.useState)(0),ye=je[0],ve=je[1],be=(0,m.useState)(0),we=be[0],Ne=be[1],Ce=(0,m.useState)(""),Se=Ce[0],Ze=Ce[1],ke=(0,d.useRouter)(),Be=(0,d.useRouter)().query,Pe=Be.tokenId,_e=Be.seller,Ee=Be.price,Fe=Be.pay;(0,m.useEffect)((function(){var e=function(){var e=(0,l.Z)((function(){var e,t,n,l,i,u,d,m,x,h,p,C;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:console.log("providers:",v),console.log("loading:",Z),ae(!0),"Ethereum"===S?(s=g.xC.tokenContractAddr,r=g.xC.marketplaceContractAddr):"Binance"===S&&(s=g.t4.tokenContractAddr,r=g.t4.marketplaceContractAddr),e=Z?Z.getSigner():new b.r(g.xC.RPC_URL),a=new w.CH(s,j.Z,e),o=new w.CH(r,y.Z,e),c.label=1;case 1:return c.trys.push([1,9,,10]),console.log("tokenId:",{tokenId:Pe}),[4,a.uri(Pe)];case 2:return t=c.sent(),Y(t),console.log("tokenurl:",t),[4,a.balanceOf(f||_e,Pe)];case 3:return n=c.sent(),ie(n.toNumber()),[4,Z.getBalance(f)];case 4:return l=c.sent(),Ze(l.toString()),[4,D().get(t)];case 5:return i=c.sent().data,ne(i.description),G(i.image),$(i.name),i.email&&ge(i.email),[4,o.getSaleTokensBySellerAndTokenId(_e,Pe)];case 6:return u=c.sent(),console.log("sales:",u),console.log("seller is:",_e,f),d=u[0],T(Ee.toString()),Ne((0,N.Z)(Ee.toString()).div((0,N.Z)("1000000000000000000")).toNumber()),m=u[1],console.log("amounts:",m),(x=d.findIndex((function(e){return e.toString()===Ee.toString()})))<0&&ke.push("/"),console.log("current amount:",m[x],m[x].toNumber()),O(m[x].toNumber()),de(m[x].toNumber()),[4,a.maxSupply(Pe)];case 7:return h=c.sent(),E(h.toNumber()),[4,D().get("https://api.coingecko.com/api/v3/simple/price?ids=matic-network&vs_currencies=usd")];case 8:return p=c.sent().data,ve(p["matic-network"].usd),[3,10];case 9:return C=c.sent(),console.log("error",C),[3,10];case 10:return ae(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}();e()}),[f,Pe,Z]);var Le=function(){var e=(0,l.Z)((function(e){var t,n,s;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:t={Destination:{CcAddresses:[fe],ToAddresses:[fe]},Message:{Body:{Html:{Charset:"UTF-8",Data:"<div>".concat(f," has successfully bought ").concat(xe," ").concat(W," on transaction ").concat(e,"</div>")},Text:{Charset:"UTF-8",Data:"".concat(f," successfully bought ").concat(xe," ").concat(W," on transaction ").concat(e)}},Subject:{Charset:"UTF-8",Data:"Poulina Marketplace"}},Source:"omuniverse823@gmail.com",ReplyToAddresses:["omuniverse823@gmail.com"]},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,M.sendEmail(t).promise()];case 2:return n=r.sent(),console.log("email sent:",n),[3,4];case 3:return s=r.sent(),console.log("error:",s),[3,4];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),De=function(){var e=(0,l.Z)((function(){var e,t,s;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:if(e=(0,N.Z)(Ee).multipliedBy(xe),console.log("buying:",Pe,Ee,xe,f,e.toString()),xe>I)return[2,(0,_.sD)("Insufficient token to buy")];if(0===xe)return[2,(0,_.sD)("Buy more than 1 token")];if(e.gt((0,N.Z)(Se)))return[2,(0,_.sD)("Insufficient fund")];ae(!0),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,o.purchase(_e,Pe,Ee,xe,{from:f,value:e.toString()})];case 2:return[4,r.sent().wait()];case 3:return t=r.sent(),[4,Le(t.transactionHash)];case 4:return r.sent(),H.fire({title:(0,u.jsx)(P.Z,{component:"h2",children:"Congratulation!"}),html:(0,u.jsx)(P.Z,{component:"p",children:"You bought the fractions."}),icon:"success"}),n(!1),ke.push("/own-list"),[3,6];case 5:return s=r.sent(),console.log("error",s),[3,6];case 6:return ae(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Te=function(){var e=(0,l.Z)((function(){var e;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:if(ae(!0),0===ue)return[2,(0,_.sD)("Unlist more than 1 token")];if(ue>I)return[2,(0,_.sD)("Exceeds listed amount")];t.label=1;case 1:return t.trys.push([1,4,,5]),[4,o.cancelSale(Pe,Ee,ue)];case 2:return[4,t.sent().wait()];case 3:return t.sent(),H.fire({title:(0,u.jsx)(P.Z,{component:"h2",children:"Congratulation!"}),html:(0,u.jsx)(P.Z,{component:"p",children:"You unlisted the fractions."}),icon:"success"}),p(!1),ke.push("/own-list"),[3,5];case 4:return e=t.sent(),console.log("error",e),[3,5];case 5:return ae(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}();return console.log("bucynt:",xe),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(U(),{children:(0,u.jsxs)("title",{children:[W," PayByMint"]})}),(0,u.jsxs)("section",{className:"w-11/12 max-w-6xl mx-auto my-7",children:[(0,u.jsx)(R,{tokenId:Pe,name:W,description:te,tokenUrl:X,image:J,loading:re,vfpEth:L,fraction:B,totalFraction:le,frcCount:I,walletAddress:f,seller:_e,onPay:function(){n(!0)},onUnlist:function(){p(!0)},pay:Fe}),(0,u.jsx)(C.Ix,{style:{fontSize:12,padding:"5px !important",lineHeight:"15px"}}),t&&(0,u.jsx)(z,{setShow:n,vfpEth:L,frcCount:xe,setFrcCount:he,loading:re,buy:De,maxFraction:I,isPay:Fe,polygonPrice:ye,totalPrice:we,setTotalPrice:Ne}),h&&(0,u.jsx)(V,{setShow:p,vfpEth:L,frcCount:ue,setFrcCount:de,loading:re,unlist:Te,maxFraction:I})]})]})}var R=function(e){e.tokenId;var t=e.name,n=void 0===t?"Directions Real Estate Currency":t,s=e.description,r=(e.edition,e.set,e.currentValueEth,e.currentValueDollar,e.tokenUrl,e.image),a=e.loading,o=e.vfpEth,l=e.frcCount,c=(e.vfpDollar,e.fraction,e.walletAddress),d=e.seller,x=(e.totalFraction,e.onPay),h=(e.pay,e.onUnlist);return(0,u.jsxs)(m.Fragment,{children:[(0,u.jsxs)("div",{className:"flex flex-col items-center md:flex-row md:items-stretch gap-4",children:[(0,u.jsx)("img",{src:""!==r?r:"",alt:"nft",className:"w-[350px] h-[350px] shadow-2xl rounded-md"}),(0,u.jsxs)("div",{className:"relative shadow-2xl rounded-md p-6 flex-1 flex flex-col justify-between",children:[(0,u.jsxs)("button",{className:"flex items-center absolute top-2 right-4 text-rolling-stone text-sm",onClick:function(){var e=window.location.href;e.includes("?pay=true")||(e+="?pay=true"),navigator.share?navigator.share({title:n+" - PayByMint",text:"Pay with NFT (".concat(n,") on PayByMint"),url:e}).then((function(){return console.log("Successful share")})).catch((function(e){return console.log("Error sharing",e)})):console.log("Unable to share. Not supported.")},children:[(0,u.jsx)(f.Z,{width:"20",type:"share",className:"mr-1"}),(0,u.jsx)("span",{children:"Share"})]}),(0,u.jsx)("h2",{className:"font-bold text-xl",children:n}),(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{className:"text-trout text-sm text-opacity-50 font-medium",children:"Description :"}),(0,u.jsx)("span",{className:"text-trout text-sm font-medium",children:s})]}),(0,u.jsxs)("div",{className:"flex",children:[(0,u.jsxs)("div",{className:"p-4 pl-0 pr-6",children:[(0,u.jsx)("p",{className:"text-trout text-opacity-50 text-sm font-medium",children:"Current Value"}),(0,u.jsxs)("p",{className:"flex items-center",children:[(0,u.jsx)("span",{children:(0,u.jsx)(f.Z,{type:"ether"})}),(0,u.jsxs)("span",{className:"ml-1",children:[(0,u.jsx)("span",{className:"font-bold",children:(0,N.Z)(o).multipliedBy((0,N.Z)(l)).dividedBy((0,N.Z)("1000000000000000000")).toString()})," "]})]})]}),(0,u.jsxs)("div",{className:"p-4 pr-6 ",children:[(0,u.jsx)("p",{className:"text-trout text-opacity-50 text-sm border-l border-l-light-orange pl-3 font-medium",children:"Value per fraction"}),(0,u.jsxs)("p",{className:"flex items-center border-l border-l-light-orange pl-3",children:[(0,u.jsx)("span",{children:(0,u.jsx)(f.Z,{type:"ether"})}),(0,u.jsxs)("span",{className:"ml-1",children:[(0,u.jsx)("span",{className:"font-bold",children:(0,N.Z)(o).dividedBy((0,N.Z)("1000000000000000000")).toString()})," "]})]})]}),(0,u.jsxs)("div",{className:"p-4 pr-6 ",children:[(0,u.jsx)("p",{className:"text-trout text-opacity-50 text-sm border-l border-l-light-orange pl-3 font-medium",children:"Fraction"}),(0,u.jsxs)("p",{className:"flex items-center border-l border-l-light-orange pl-3",children:[(0,u.jsx)("span",{children:(0,u.jsx)(f.Z,{type:"ether"})}),(0,u.jsxs)("span",{className:"ml-1",children:[(0,u.jsx)("span",{className:"font-bold",children:l})," "]})]})]})]}),!!c&&(0,u.jsx)("div",{className:"flex items-center",children:(null===c||void 0===c?void 0:c.toLowerCase())===(null===d||void 0===d?void 0:d.toLowerCase())?(0,u.jsx)("button",{onClick:h,className:"bg-vermilion rounded-3xl py-2 px-7 text-white font-bold",children:"Unlist"}):(0,u.jsx)("button",{onClick:function(){return x()},className:"bg-vermilion rounded-3xl py-2 px-7 text-white font-bold",children:"Pay By Mint"})})]})]}),a&&(0,u.jsx)("div",{style:(0,i.Z)({position:"fixed",top:"0px",left:"0px",zIndex:"10000000000 !important",width:"100%",height:"100%",backgroundColor:"#ffffff",opacity:"0.5"},"zIndex","10000"),children:(0,u.jsx)(T.Z,{type:"Puff",height:100,width:100,style:{position:"fixed",top:"calc(50% - 50px)",left:"calc(50% - 50px)"}})})]})},z=function(e){e.amountEth,e.amountDollar,e.fraction;var t=e.setShow,n=e.vfpEth,s=e.frcCount,r=e.maxFraction,a=e.setFrcCount,o=e.loading,l=e.polygonPrice,i=e.buy,c=(e.email,e.isPay,e.totalPrice),d=e.setTotalPrice;return(0,u.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-80 w-screen h-screen overflow-hidden",children:(0,u.jsxs)("div",{className:"w-full max-w-md bg-white rounded-lg shadow-lg overflow-hidden text-center p-4 relative",children:[(0,u.jsx)("button",{onClick:function(){return t(!1)},className:"absolute top-2 right-2",children:(0,u.jsxs)("svg",{width:"30",height:"30",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,u.jsx)("circle",{cx:"16",cy:"16",r:"16",fill:"#C4C4C4"}),(0,u.jsx)("path",{d:"M16.8546 16.0001L20.9464 11.9084C21.1819 11.6729 21.1819 11.2922 20.9464 11.0567C20.7108 10.8212 20.3302 10.8212 20.0946 11.0567L16.0029 15.1484L11.9112 11.0567C11.6756 10.8212 11.295 10.8212 11.0595 11.0567C10.8239 11.2922 10.8239 11.6729 11.0595 11.9084L15.1512 16.0001L11.0595 20.0918C10.8239 20.3274 10.8239 20.708 11.0595 20.9436C11.1769 21.061 11.3311 21.12 11.4853 21.12C11.6395 21.12 11.7937 21.061 11.9112 20.9436L16.0029 16.8518L20.0946 20.9436C20.2121 21.061 20.3663 21.12 20.5205 21.12C20.6747 21.12 20.8289 21.061 20.9463 20.9436C21.1819 20.708 21.1819 20.3274 20.9463 20.0918L16.8546 16.0001Z",fill:"white"})]})}),(0,u.jsx)("h4",{className:"text-cape-cod font-medium mb-4",children:"Total Bill"}),(0,u.jsx)("div",{className:"bg-vermilion bg-opacity-20 rounded-[50%] p-4 w-28 mx-auto flex justify-center items-center",children:(0,u.jsx)("img",{width:"60",src:"/assets/dollar.svg",alt:"dollar"})}),(0,u.jsx)("p",{className:"text-shuttle-gray mt-5",children:"Amount"}),(0,u.jsxs)("p",{className:"flex items-center justify-center",children:[(0,u.jsx)("span",{children:(0,u.jsx)(f.Z,{type:"ether"})}),(0,u.jsxs)("span",{className:"ml-1",children:[(0,u.jsx)("span",{className:"font-bold",children:(0,N.Z)(s).multipliedBy((0,N.Z)(n)).dividedBy((0,N.Z)("1000000000000000000")).toString()})," "]})]}),(0,u.jsx)("p",{className:"mt-1",children:(0,u.jsxs)("span",{className:"ml-1",children:[(0,u.jsxs)("span",{className:"font-bold",children:[s," Fraction"]})," "]})}),(0,u.jsx)("p",{className:"flex items-center justify-center border-b border-b-gray-300",children:(0,u.jsx)("span",{className:"ml-1",children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",marginTop:"5px",marginBottom:"15px"},children:[(0,u.jsx)("input",{type:"number",className:"form-control",style:{width:"100px"},max:r*l,onChange:function(e){d(e.target.value),a(Math.floor((0,N.Z)(e.target.value).div((0,N.Z)(l)).times((0,N.Z)("1000000000000000000")).div(n).toNumber()))},value:c})," USD"]})})}),(0,u.jsx)("button",{className:"bg-orange text-white mx-auto px-6 py-2 rounded-md mt-5",onClick:function(){return i()},children:o?(0,u.jsx)(F(),{size:"34px",width:"4px"}):"Pay Now"})]})})},V=function(e){e.amountEth,e.amountDollar,e.fraction;var t=e.setShow,n=e.vfpEth,s=e.frcCount,r=(e.maxFraction,e.setFrcCount),a=e.loading,o=e.unlist;return console.log("current fractions:",s,n),(0,u.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-80 w-screen h-screen overflow-hidden",children:(0,u.jsxs)("div",{className:"w-full max-w-md bg-white rounded-lg shadow-lg overflow-hidden text-center p-4 relative",children:[(0,u.jsx)("button",{onClick:function(){return t(!1)},className:"absolute top-2 right-2",children:(0,u.jsxs)("svg",{width:"30",height:"30",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,u.jsx)("circle",{cx:"16",cy:"16",r:"16",fill:"#C4C4C4"}),(0,u.jsx)("path",{d:"M16.8546 16.0001L20.9464 11.9084C21.1819 11.6729 21.1819 11.2922 20.9464 11.0567C20.7108 10.8212 20.3302 10.8212 20.0946 11.0567L16.0029 15.1484L11.9112 11.0567C11.6756 10.8212 11.295 10.8212 11.0595 11.0567C10.8239 11.2922 10.8239 11.6729 11.0595 11.9084L15.1512 16.0001L11.0595 20.0918C10.8239 20.3274 10.8239 20.708 11.0595 20.9436C11.1769 21.061 11.3311 21.12 11.4853 21.12C11.6395 21.12 11.7937 21.061 11.9112 20.9436L16.0029 16.8518L20.0946 20.9436C20.2121 21.061 20.3663 21.12 20.5205 21.12C20.6747 21.12 20.8289 21.061 20.9463 20.9436C21.1819 20.708 21.1819 20.3274 20.9463 20.0918L16.8546 16.0001Z",fill:"white"})]})}),(0,u.jsx)("h4",{className:"text-cape-cod font-medium mb-4",children:"Total Bill"}),(0,u.jsx)("div",{className:"bg-vermilion bg-opacity-20 rounded-[50%] p-4 w-28 mx-auto flex justify-center items-center",children:(0,u.jsx)("img",{width:"60",src:"/assets/dollar.svg",alt:"dollar"})}),(0,u.jsx)("p",{className:"text-shuttle-gray mt-5",children:"Amount"}),(0,u.jsxs)("p",{className:"flex items-center justify-center",children:[(0,u.jsx)("span",{children:(0,u.jsx)(f.Z,{type:"ether"})}),(0,u.jsxs)("span",{className:"ml-1",children:[(0,u.jsx)("span",{className:"font-bold",children:(0,N.Z)(s).multipliedBy((0,N.Z)(n)).dividedBy((0,N.Z)("1000000000000000000")).toString()})," "]})]}),(0,u.jsx)("p",{className:"text-shuttle-gray mt-5",children:"NFT Fraction"}),(0,u.jsx)("p",{className:"flex items-center justify-center border-b border-b-gray-300",children:(0,u.jsx)("span",{className:"ml-1",children:(0,u.jsx)("input",{type:"number",className:"form-control",style:{margin:"20px",width:"100px"},min:"1",max:s,onChange:function(e){return r(e.target.value)},value:s})})}),(0,u.jsx)("button",{className:"bg-orange text-white mx-auto px-6 py-2 rounded-md mt-5",onClick:function(){return o()},children:a?(0,u.jsx)(F(),{size:"34px",width:"4px"}):"Unlist"})]})})}},28022:function(){},36823:function(e){"use strict";e.exports=JSON.parse('{"accessKeyId":"","secretAccessKey":"","region":"us-east-1"}')}},function(e){e.O(0,[586,166,669,794,293,571,545,774,888,179],(function(){return t=24833,e(e.s=t);var t}));var t=e.O();_N_E=t}]);